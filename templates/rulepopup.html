

<!-- edit modal -->
<div id="editModal" class="modal fade"  data-backdrop="static" role="dialog">

	<div class="alert alert-success alert-dismissable" id="delete-srule-alert" >
                        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times</a>
                        <strong>Success!</strong> Rule deleted.
        </div>
	<div class="alert alert-danger alert-dismissable" id="save-erule-alert" style="display:none;">
                        <a href="#" class="close" data-dismiss="alert"  aria-label="close">&times</a>
                        Rule name already exists.
        </div>
     <div class="alert alert-success alert-dismissable text-center" id="save-srule-alert" >
                        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times</a>
                        <strong>Success</strong> Rule saved.
        </div>
	<div class="alert alert-danger alert-dismissable" id="cond-alert" >
                        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times</a>
                        Atleast one condition should be present
        </div>
        <div class="modal-dialog modal-lg">

                <!-- Modal content-->
                <div class="modal-content">
                        <div class="modal-header">
                                <!--<button type="button" class="close" data-dismiss="modal">&times;</button>-->
				<button type="button" class="close" data-dismiss="modal" ng-click="reset()"><i class="fa fa-times" style="color:white;" aria-hidden="true"></i>
</button>
                                <h4 class="modal-title">Rule Wizard</h4>
                        </div>
                        <div class="modal-body rulebody">
                        	<form class = "form-inline" id = "editForm" name="editForm" ng-submit="submit()">
                        	   <div class ="settings">Settings</div>
                                <div class="row setting" style="margin-bottom:2px;">
                                    <div class="col-xs-3">
                                        <div class="form-group">
                                                <label for="rule-name">Name:</label>
                                                <input type="text" ng-if = "rule_name != '' " class="form-control input-sm" id="rule-name" ng-model="rule_name" placeholder="Enter Rule Name" ng-disabled="true"  required>
                                                <input type="text" ng-if = "rule_name == '' " class="form-control input-sm" id="rule-name" maxlength="16" ng-model="rule_name" placeholder="Enter Rule Name" required>
                                        </div>
                                    </div>
                                    <div class="col-xs-2">
                                        <div class="form-group">
                                                <label for="score">Score:</label>
                                                <input type="number" min="0" max="512" class="form-control input-sm" id="score" ng-model="score" placeholder="Score" style="width:65px;" required>
                                        </div>
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox" ng-model="status" id="status">  Enable
                                    </div>
                                    <div class="col-xs-2">
                                        <input type="checkbox"  ng-model="mode"  id="mode">  Active Mode
                                    </div>
                                    <div class="col-xs-3">
                                        <label for="ttl">TTL:</label>
                                        <input type="text" ng-model="ttl" style="width:80px;" class="form-control input-sm" id="ttl" placeholder="sec" required>sec
                                    </div>
                                </div>
                                <div class="row setting">
                                    <div class="col-xs-3 form-group">
                                        <label for="key-strategy">Key Strategy:</label> 
								        <select id = "key-strategy" class="form-control"  ng-options="val for val in ['0','1']" ng-model="key_strategy" title="key strategy" required>
									       <option value="">Select</option>
								        </select>
                                    </div>
                                    <div class="col-xs-2 form-group" style="margin-top:8px;padding:0px -30px 0px 0px;">
                                        <label for ="reason-code" >Reason Code:</label>
                                    </div>
                                    <div class="col-xs-2 form-group" style="margin:0px 0px 0px -30px;" ng-dropdown-multiselect="" id="reason-code" options="options_reasoncode" selected-model="reason_code_model" extra-settings="reasoncode_settings" events="callEvents"></div>
                                    <div class="col-xs-2">
                                        <input type="checkbox"  ng-model="rc_auto" id="rc_auto"> RC Autodetect
                                    </div>
                                    <div class="col-xs-3 form-group">
                                        <label for="response-code">Response Code:</label>
								        <select id = "response-code" ng-options="('r'+val) for val in ['1','2','5']" ng-model="response_code" class="form-control" title="response-code" required>
                                            <option value="">Select</option>
								        </select>
                                    </div>
                                </div>
			<div class ="settings">Conditions</div>
			<div class= "cond-table-container" id="div-table-cond" style = "max-height:230px;overflow-y:auto;">
                <table class="table table-striped table-bordered" id="cond-tab">
                    <thead>
                        <tr>
                            <th></th><!--<input type="checkbox" ng-model="selectedAll" ng-click="checkAll()" /></th>-->
                            <th>Feature</th>
                            <th>Type</th>
                            <th>Operator</th>
                            <th>Value</th>
                            <th>Feature</th>
                            <th>String</th>
                        </tr>
                    </thead>
                    <tbody id = "cond-table">
                        <tr ng-repeat="cond in cond_json">
                            <td>
                                <input type="checkbox" ng-show="cond_json_len > 1" ng-model="cond.selected"/></td>
                            <td>
                                <select  ng-options="val for (key,val) in features " class="form-control" ng-model="cond.feature_lhs" required/><option value="">Select Feature</option></select></td>
                            <td>
                                <select ng-options="type for type in types" class="form-control" ng-model="cond.type" required><option value="">Select Type</option></select></td>
                            <td>
					            <select  ng-options=" op for op in bool_op" ng-if="cond.type == 0" class="form-control" ng-model="cond.operator" required><option value="">Select Operator</option></select>
					            <select  ng-options=" op for op in op_for_hash" ng-if="cond.type == 4" class="form-control" ng-model="cond.operator" required><option value="">Select Operator</option></select>
                                <select  ng-options="op for op in operator" ng-if="cond.type ==1 || cond.type ==2 || cond.type==3" class="form-control" ng-model="cond.operator" required><option value="">Select Operator</option></select>
                                <select  ng-options="op for op in op_for_pmatch" ng-if="cond.type ==5" class="form-control" ng-model="cond.operator" required><option value="">Select Operator</option></select>
                                <select  ng-options="op for op in op_for_ssmatch" ng-if="cond.type ==6" class="form-control" ng-model="cond.operator" required><option value="">Select Operator</option></select>
                            </td>
				        	<td>
					            <select ng-options = "val for (key,val) in constants"  ng-if="cond.type == 1"  class="form-control" ng-model="cond.val_param" required><option value="">Select</option></select>
                                <select ng-options = "val for (key,val) in pct_const"  ng-if="cond.type==2" class="form-control" ng-model="cond.val_param" required><option value="">Select</option></select>
				                <select ng-options = "val for val in boolean"  ng-if="cond.type==0" class="form-control" ng-model="cond.val_param" required><option value="">Select</option></select>
				                <input type = "text" ng-if="cond.type == 3 || cond.type == 4 || cond.type == 5 || cond.type == 6" class="form-control text-center" ng-model="na" ng-init = "na='NA'" ng-disabled="true" required>
                            </td>
                            <td>
                                <input type = "text" ng-if="cond.type == 0 || cond.type == 1 || cond.type == 4" class="form-control text-center" ng-model="na" ng-init = "na='NA'" ng-disabled="true" required>
                                <select ng-if="cond.type == 2 || cond.type == 3 ||  cond.type == 5 || cond.type == 6" ng-options="v for (k,v) in features" class="form-control" ng-model="cond.feature_rhs" required><option value="">Select Feature</option></select></td>
                            <td>
                                <input type = "text" ng-if="cond.type == 0 || cond.type == 1 || cond.type == 2 || cond.type == 3 || cond.type == 5 || cond.type == 6" class="form-control text-center" ng-model="na" ng-init = "na='NA'" ng-disabled="true" required>
                                <input ng-if="cond.type == 4 && cond.operator == ''" type="text" class="form-control" ng-model="cond.pattern_string" required/>
                                <input ng-if="cond.type == 4 && cond.operator == 'hexists'" type="text" class="form-control" ng-model="cond.pattern_string" pattern="^H:.*" title="should start with H:" required/>
                                <input ng-if="cond.type == 4 && cond.operator == 'sismember'" type="text" class="form-control" ng-model="cond.pattern_string" pattern="^S:.*" title="should start with S:" required/></td>
                        </tr>
                    </tbody>
                </table>
			</div>
                            <div class="form-group" style="margin-top:8px;">
                                <input id="rowIndex" class="form-control" type = "number" min=0 style="width:50px;" required>
                                <input type="button" class="btn btn-primary addnew pull-center" id ="add-cond" ng-click="addNew()" value="Add New">
                                <input ng-hide="!cond_json.length" type="button" class="btn btn-danger pull-center" ng-click="remove()" value="Remove">
                            </div>
                        </div>
                        <div class="modal-footer">
                                <i class="fa fa-spinner fa-spin fa-3x fa-fw" id="save-loader"></i><span class="sr-only">Loading...</span>
                                <button type="submit"  class="btn btn-success"><span>Save</span></button>
				                <!--<button type="button" class="btn btn-danger" ng-if="sid_val == 0" ng-click="delete()">Delete</button>-->
					
			</div>
			</form>
                </div>
        </div>
</div>


{% include "confirm-delete.html" %}
